module WasRun : sig

  type t

  val make : string -> t
  val wasRun : t -> bool
  val run: t -> unit
  val testMethod: t -> unit

end = struct

  type s = bool ref
  type t = s

  let make name =
    let-mutable r <- false in
    r

  let wasRun test =
    !test

  let testMethod test =
    test <- true

  let run test =
    test |> testMethod

end
